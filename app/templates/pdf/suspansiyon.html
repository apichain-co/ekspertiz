<style>
    .suspansiyonTable {
        width: 100%;
        height: 200px;
        border-collapse: collapse;
        table-layout: fixed; /* Fix the layout to avoid row height overflow */
    }

    .suspansiyonTable td {
        height: 100px; /* Set height */
        overflow: hidden; /* Prevent overflow */
        vertical-align: middle; /* Vertically center content */
    }

    .first-column {
        width: 3%;
    }

    .extraSuspansiyon {
        width: 60%; /* Remainder width */
        padding: 50px 100px; /* Add padding around the image */
        text-align: center; /* Center the image horizontally */
    }

    .suspansiyonImg {
        max-height: 30%; /* Ensure the image fits within the available space */
        width: auto; /* Maintain the aspect ratio */
    }
    /* Style for the labels and scale */
    .scale-container {
        text-align: center;
        margin-top: 10px;
    }

    .scale {
        display: inline-block;
        font-size: 14px;
        letter-spacing: 2px;
    }

    .status-labels {
        display: flex;
        justify-content: center;
        margin-top: 10px;
    }

    .status-label {
        padding: 5px 10px;
        color: white;
        border-radius: 10px;
        margin: 0 5px;
        font-size: 14px;
        font-weight: bold;
    }

    .arizali {
        background-color: #ff4d4d; /* Red */
    }

    .kontrol {
        background-color: #ffcc00; /* Yellow */
    }

    .iyi {
        background-color: #9933ff; /* Purple */
    }

    .cokiyi {
        background-color: #33ccff; /* Light Blue */
    }

    .mukemmel {
        background-color: #33cc33; /* Green */
    }

</style>
{% macro get_feature_value(features, name) %}
{% for feature in features %}
{% if feature.name == name %}
{{ feature.status }}
{% endif %}
{% endfor %}
{% endmacro %}

<div class="title-large primary-color primary-bg-color" style="position: relative; padding: 15px;">
    <span style="color: white;">SÜSPANSİYON & YANAL KAYMA EKSPERTİZ RAPORU</span>
    <div class="sasi-wrapper" style="position: absolute; right: 1%; top: 50%; transform: translateY(-50%); padding: 0 10px; background-color: white; border-left: 0;">
        <table width="100%">
            <tbody>
            <tr>
                <td class="" style="font-size: 12px; font-weight: bold; ">
                    ŞASİ NO<span style="font-size: 14px; ">:</span>
                </td>
                <td class=" text-medium" rowspan="2" style="font-size: 20px; font-weight: bold;">
                    {{ vehicle.chassis_number[-6:] }}
                </td>
            </tr>
            <tr>
                <td class=" text-small" style="font-size: 8px; text-align:center;  ">
                    SON 6 HANE
                </td>
            </tr>
            </tbody>
        </table>
    </div>
</div>

<table class="suspansiyonTable">
    <tr>
        <td class="on-frenler  first-column frentd hTitle " ><span class="rotate-text">SÜSPANSİYON TESTİ</span></td>
        <td class="extraSuspansiyon frentd" rowspan="2" width="350" valign="top">
            <div class="aracgovde fren">
                <div class="bg">
                    <img class="suspansiyonImg" src="{{ fren_image_url }}" alt="Frenler">
                    <span class="yon top">ÖN</span>
                    <span class="yon right">SAĞ</span>
                    <span class="yon bottom">ARKA</span>
                    <span class="yon left">SOL</span>
                    {% set on_sol_fren = get_feature_value(pckg_report.features, 'SOL ÖN')|float %}
                    {% set on_sag_fren = get_feature_value(pckg_report.features, 'SAĞ ÖN')|float %}
                    <!-- ÖN SOL FREN -->
                    <span class="olcum solOn">
                        <span class="deger">
                            <span id="olcumSolOn" class="fren-span">%{{ on_sol_fren|int }}</span>
                        </span>
                    </span>



                    <!-- Sapma Hesaplaması ve Sonuç -->
                    {% if on_sol_fren > 0 %}
                    {% set sapma_on = ((on_sol_fren - on_sag_fren)|abs / on_sol_fren * 100)|round(2) %}
                    {% else %}
                    {% set sapma_on = 0 %}
                    {% endif %}

                    <span class="sapmaOn fren" style="display: inline;">
                            SAPMA <span class="sapmaOnDeger fren green">%{{ sapma_on }}%</span>
                        </span>
                    <span class="sonucOn fren {{ 'green' if sapma_on <= 30 else 'red' }}" style="display: inline;">
                            {{ 'GEÇTİ' if sapma_on <= 30 else 'KALDI' }}
                        </span>

                    <!-- ÖN SAĞ FREN -->
                    <span class="olcum sagOn">
                            <span class="deger">
                            <span id="olcumSagOn" class="fren-span">%{{ on_sag_fren|int }}</span>
                            </span>
                    </span>



                    <!-- Sapma Hesaplaması ve Sonuç -->
                    {% set arka_sol_fren = get_feature_value(pckg_report.features, 'SOL ARKA')|float %}
                    {% set arka_sag_fren = get_feature_value(pckg_report.features, 'SAĞ ARKA')|float %}
                    <!-- ARKA SOL FREN -->
                    <span class="olcum solArka">
                            <span class="deger">
                               <span id="olcumSolArka" class="fren-span">%{{ arka_sol_fren|int }}</span>
                            </span>
                    </span>



                    {% if arka_sol_fren > 0 %}
                    {% set sapma_arka = ((arka_sol_fren - arka_sag_fren)|abs / arka_sol_fren * 100)|round(2) %}
                    {% else %}
                    {% set sapma_arka = 0 %}
                    {% endif %}

                    <span class="sapmaArka fren" style="display: inline;">
                            SAPMA <span class="sapmaArkaDeger fren green">%{{ sapma_arka }}%</span>
                        </span>
                    <span class="sonucArka fren {{ 'green' if sapma_arka <= 30 else 'red' }}" style="display: inline;">
                            {{ 'GEÇTİ' if sapma_arka <= 30 else 'KALDI' }}
                        </span>

                    <!-- ARKA SAĞ FREN -->
                    <span class="olcum sagArka">
                            <span class="deger">
                               <span id="olcumSagArka" class="fren-span">%{{ arka_sag_fren|int }}</span>
                            </span>
                        </span>
                </div>

            </div>
            <div class="scale-container">
                <div class="scale">
                    0---10---20---30---40---50---60---70---80---90---100
                </div>

                <!-- Status Labels -->
                <div class="status-labels">
                    <span class="status-label arizali">ARIZALI</span>
                    <span class="status-label kontrol">KONTROL</span>
                    <span class="status-label iyi">İYİ</span>
                    <span class="status-label cokiyi">ÇOK İYİ</span>
                    <span class="status-label mukemmel">MÜKEMMEL</span>
                </div>
            </div>
        </td>

    </tr>

</table>

